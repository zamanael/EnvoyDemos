<?xml version="1.0"?>
<configuration>
  <configSections>
    <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
      <section name="CardAccess.DataPumpService.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" />
    </sectionGroup>
  </configSections>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2"/>
  </startup>
  <userSettings>
    <CardAccess.DataPumpService.Settings>
      <setting name="AGRepFileName" serializeAs="String">
        <value>C:\TfsProjects\AccessControl\CardAccess4K_1.0.90\output\AG Replacement.cfg</value>
      </setting>
      <setting name="PollingInterval" serializeAs="String">
        <value>5000</value>
      </setting>
      <setting name="UserField1Name" serializeAs="String">
        <value>userfield1</value>
      </setting>
      <setting name="UserField2Name" serializeAs="String">
        <value>userfield2</value>
      </setting>
      <setting name="ScanFolder" serializeAs="String">
        <value>C:\TfsProjects\AccessControl\CardAccess4K_1.0.90\output\Import</value>
      </setting>
      <setting name="PartitionsToInsert" serializeAs="String">
        <value>Admin Partition|Campus</value>
      </setting>
      <setting name="ImportType" serializeAs="String">
        <value>0</value>
      </setting>
      <setting name="sql_supervisor" serializeAs="String">
        <value>IF NOT EXISTS (SELECT PersonID FROM Person WHERE Supervisor=1 AND (LastName + ' ' + CASE WHEN ISNULL(MiddleName,'')='' THEN '' ELSE MiddleName + ' ' END + FrstName)=@Manager ) 
 BEGIN
	IF NOT EXISTS (SELECT PersonID FROM Person WHERE Supervisor=1 AND (FrstName+ ' '+LastName)=@Manager)
	BEGIN
		SELECT PersonID FROM Person WHERE Supervisor=1 AND (FrstName+ ' '+LastName)=@Manager
	END
	ELSE
		SELECT PersonID FROM Person WHERE Supervisor=1 AND (FrstName+ ' '+LastName)=@Manager
 END
 ELSE
	SELECT PersonID FROM Person WHERE Supervisor=1 AND (LastName + ' ' + CASE WHEN ISNULL(MiddleName,'')='' THEN '' ELSE MiddleName + ' ' END + FrstName)=@Manager</value>
      </setting>
    </CardAccess.DataPumpService.Settings>
  </userSettings>
</configuration>
